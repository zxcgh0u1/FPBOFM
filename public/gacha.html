<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <title>FPBOFM — Гача</title>
  <link rel="stylesheet" href="/styles/base.css"/>
  <link rel="stylesheet" href="/styles/layout.css"/>
</head>
<body>
<header class="topbar"></header>
<main class="container">
  <h1>Гача</h1>
  <button id="open-egg">Открыть яйцо</button>
  <button id="open-chest">Открыть сундук</button>
  <div id="result"></div>
</main>
<script type="module">
import { http } from '/js/api/http.js';
import { renderHeader } from '/js/header.js';
import { store } from '/js/state/store.js';
await store.ensureAuth();
renderHeader();

const box = document.getElementById('result');
async function open(kind) {
  try {
    const r = await http('/gachas/' + kind, { method: 'POST' });
    box.innerHTML = `<p>Выпал: <b>${r.name}</b> (${r.rarity})</p>`;
  } catch (e) {
    box.innerHTML = `<p style="color:red;">${e.message}</p>`;
  }
}
document.getElementById('open-egg').onclick = () => open('egg');
document.getElementById('open-chest').onclick = () => open('chest');
</script>
</body>
</html>
